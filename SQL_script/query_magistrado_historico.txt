    AS FECHA_PROCESO,
    A.IDANOPROC,
    A.IDUEJECOD, 
    UE.UEJEDESCRIP UEJECUTORA,
    ORG.IDOFIORGCODIGO AS COD_DISTRITO, ORG.OFIORGDESCRIP AS DES_DISTRITO,
    O.IDOFITIPDEPCOD AS COD_TIPODEPENDENCIA, OTD.OFITIPDEPDESC AS DES_TIPODEPENDENCIA,
    O.IDOFICODIGO AS COD_DEPENDENCIA, O.MOFIDESCRI AS DES_DEPENDENCIA,
    O.ofidirecc DIRECCION,
    DOC.DIPNUMERO AS DNI,
    H.MPPIAPPATER || ' ' || H.MPPIAPMATER || ', ' || H.MPPINOMBRES AS NOMBRES,
    (CASE WHEN P.PERSEXO = 'F'THEN 'FEMENINO'
          WHEN P.PERSEXO = 'M'THEN 'MASCULINO'
     ELSE '' END) AS SEXO,
    UEF.UEJEDESCRIP AS UBICA_UEJEC,
    ORGF.OFIORGDESCRIP AS UBICA_DISJU,
    LOC.MLODESCRI AS UBICA_LOCAL,
    OFIS.MOFIDESCRI AS UBICA_DEPEND,
    PU.PUEDESCRIP CARGO
FROM S_VIDALABPER A
INNER JOIN 
  (
        SELECT  DISTINCT   S.IDPPICODIGO IDPPICODIGO, 
                          S.IDCXPCODIGO IDCXPCODIGO,
                          CXPFECINI CXPFECINI, 
                          MAX(S.VLPVEZ)  VLPVEZ
                FROM  S_VIDALABPER S
        INNER JOIN S_CONDLABXPER C
                    ON C.IDPPICODIGO = S.IDPPICODIGO 
                  AND C.IDCXPCODIGO = S.IDCXPCODIGO
        WHERE S.IDANOPROC = EXTRACT(YEAR FROM sysdate) 
        AND S.IDTDOCODIGO = '933' 
        AND C.CXPESTADO = 'V' 
        AND S.VLPESTADO <> 'A' 
        AND S.VLPINDULT = '1'
        GROUP BY S.IDPPICODIGO, S.IDCXPCODIGO,CXPFECINI
  ) T ON T.IDPPICODIGO = A.IDPPICODIGO AND T.IDCXPCODIGO = A.IDCXPCODIGO AND T.VLPVEZ = A.VLPVEZ
  INNER JOIN S_PERSONAL                P     ON P.IDPPICODIGO = A.IDPPICODIGO
  INNER JOIN ENTES                     H     ON P.IDPPICODIGO = H.IDPPICODIGO
  INNER JOIN S_REGIMLAB                REG   ON A.IDRGLCODIGO = REG.IDRGLCODIGO
  INNER JOIN S_TIPMOVLAB               TMO   ON A.IDTMLCODIGO = TMO.IDTMLCODIGO
  INNER JOIN S_UNIDEJEC                UE    ON A.IDANOPROC = UE.IDUEJEANO AND A.IDUEJECOD = UE.IDUEJECOD
  LEFT JOIN S_DOCIDXPER                DOC   ON DOC.IDDIDCODIGO = '01' AND DOC.IDPPICODIGO = A.IDPPICODIGO AND DOC.DIPINDPRINC = '1'
  LEFT JOIN S_OFICINAS                 O     ON A.IDANOHIST = O.IDANOPROC AND A.IDUEJECOD = O.IDUEJECOD AND A.IDOFICODIGO = O.IDOFICODIGO
  LEFT JOIN S_OFICINAS_ORGDEP          ORG   ON O.IDUEJECOD = ORG.IDUEJECOD AND O.IDANOPROC = ORG.IDANOPROC AND O.IDOFIORGCODIGO = ORG.IDOFIORGCODIGO
  LEFT JOIN S_OFICINAS_TIPDEP          OTD   ON OTD.IDOFITIPDEPCOD = O.IDOFITIPDEPCOD
  LEFT JOIN S_REGCOND                  COL   ON A.IDRGLCODIGO = COL.IDRGLCODIGO AND A.MXCCONDICION = COL.MXCCONDICION
  LEFT JOIN ACTLOCALES                 LOC   ON A.IDUEJECOD_UB = LOC.IDUEJECOD AND A.IDCORTE_UB = LOC.IDOFIORGCODIGO AND A.IDCODLOCAL_UB = LOC.IDCODLOCAL
  LEFT JOIN S_UNIDEJEC                 UEF   ON A.IDANOPROC_UB = UEF.IDUEJEANO AND A.IDUEJECOD_UB = UEF.IDUEJECOD
  LEFT JOIN S_OFICINAS_ORGDEP          ORGF  ON A.IDUEJECOD_UB = ORGF.IDUEJECOD AND A.IDANOPROC_UB = ORGF.IDANOPROC AND A.IDCORTE_UB = ORGF.IDOFIORGCODIGO
  LEFT JOIN S_OFICINAS                 OFIS  ON A.IDANOPROC_UB = OFIS.IDANOPROC AND A.IDUEJECOD_UB = OFIS.IDUEJECOD AND A.IDOFICODIGO_UB = OFIS.IDOFICODIGO
  LEFT JOIN S_PUESTO                   PU    ON A.IDPUECODIGO = PU.IDPUECODIGO
  LEFT JOIN S_CATSERCAS                C     ON C.IDSERCASCODIGO = A.IDSERCASCODIGO
  LEFT JOIN S_CONTACXENTE              CT    ON CT.IDPPICODIGO = A.IDPPICODIGO AND CT.IDMEDCONTAC = '05' AND CT.CXEINDPRINC = '1' AND CT.CXEESTADO = '1'
  LEFT JOIN S_PAISES                   PA    ON PA.IDPAICODIGO = P.IDPAICODIGO
WHERE A.IDTDOCODIGO = '933' 
AND A.VLPESTADO = 'V'
AND A.VLPINDULT = '1'
AND A.IDANOPROC = TO_CHAR(SYSDATE, 'YYYY') 
AND A.IDPUECODIGO IN ('00258','00174','00181','00257','00163','00264','00164','00165','00262','00166','00167',
                      '00168','00169','00170','00172','00263','00173','00261','00171','00180','00278','00256',
                      '00087','00203', '00204', '00202', '00349')
and A.Idtmlcodigo not in ('163','156','011','035','034','033','032','031','030')